<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> صفحه لیست سفارشات سایت </title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /* تنظیمات اولیه */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial', sans-serif;
            direction: rtl;
            height: 100vh;
            overflow-y: auto; /* فعال کردن اسکرول عمودی */
            background-color: #000;
            background: radial-gradient(circle, rgba(0, 0, 0, 0.9), rgba(10, 10, 10, 1));
            color: #e0e0e0;
            font-size: 16px;
            padding: 50px 20px;
        }
        


        /* انیمیشن برای ایجاد حرکت ستاره‌ها */
        @keyframes moveStars {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(1000px, 1000px);
            }
        }

        /* استایل برای ذرات ستاره‌ها */
        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            display: flex;
            flex-wrap: wrap;
            animation: moveStars 60s linear infinite;
        }

        .stars .star {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.6);
            opacity: 0.9;
            animation: twinkle 2s infinite alternate;
        }

        @keyframes twinkle {
            0% {
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0.6;
            }
        }

        /* استایل پنل و سفارشات */
        #order-list {
            max-width: 900px;
            margin: 0 auto; /* مرکز کردن پنل */
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        h1 {
            text-align: center; /* مرکز کردن عنوان */
            color: #fff;
            font-size: 2rem;
            margin-bottom: 30px;
        }

        ul {
            list-style-type: none;
        }

        li {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, background-color 0.3s ease;
        }

        li:hover {
            transform: translateY(-5px);
            background-color: rgba(255, 255, 255, 0.15);
        }

        .products-list {
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            font-size: 0.95rem;
        }

        .product {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
        }

        .address {
            margin-top: 10px;
            font-size: 0.95rem;
            color: #bbb;
        }

        .footer {
            text-align: center;
            font-size: 0.9rem;
            margin-top: 40px;
            color: #bbb;
        }

        .footer a {
            color: #4e73df;
            text-decoration: none;
        }

        .btn {
            background-color: #4e73df;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #2c3e50;
        }

        /* استایل برای موبایل و تبلت */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }

            #order-list {
                padding: 20px;
            }

            li {
                padding: 15px;
            }

            .footer {
                font-size: 0.8rem;
            }
        }
            .pagination {
                text-align: center;
                margin-top: 20px;
        }

            .pagination .page {
                display: inline-block;
                margin: 0 5px;
                padding: 10px 20px;
                background-color: #333;
                color: #fff;
                cursor: pointer;
                border-radius: 5px;
            }

            .pagination .page:hover {
                background-color: #555;
            }

            .pagination .page.active {
                background-color: #007BFF;
            }

            .pagination .page:first-child {
                margin-left: 0;
            }

            .pagination .page:last-child {
                margin-right: 0;
            }


    </style>
</head>
<body>

    <div class="stars">
       
        <div class="star" style="width: 4px; height: 4px; top: 10%; left: 20%;"></div>
        <div class="star" style="width: 5px; height: 5px; top: 15%; left: 50%;"></div>
        <div class="star" style="width: 3px; height: 3px; top: 25%; left: 75%;"></div>
        <div class="star" style="width: 6px; height: 6px; top: 50%; left: 60%;"></div>
        <div class="star" style="width: 7px; height: 7px; top: 70%; left: 80%;"></div>
        <div class="star" style="width: 5px; height: 5px; top: 90%; left: 30%;"></div>
        <div class="star" style="width: 4px; height: 4px; top: 40%; left: 40%;"></div>
        <div class="star" style="width: 6px; height: 6px; top: 60%; left: 90%;"></div>
        <div class="star" style="width: 3px; height: 3px; top: 30%; left: 10%;"></div>
    </div>

    <h1>لیست سفارشات و اطلاعات مشتریان</h1>

    <div id="order-list"></div>
    <div id="pagination"></div>  

    <div class="footer">
        <p>تمامی حقوق محفوظ است. <a href="#">شرایط و قوانین</a></p>
    </div>

    <script>
        const consumerKey = ''; // کلید مصرف‌کننده خود را وارد کنید
        const consumerSecret = ''; // رمز مصرف‌کننده خود را وارد کنید
        const apiUrl = 'https://yourweb-site/wp-json/wc/v3/orders'; // URL سایت خود را وارد کنید
    
        const ordersPerPage = 6;  // تعداد سفارشات در هر صفحه
    
        // تابع برای دریافت سفارشات
        function fetchOrders(page = 1) {
            $.ajax({
                url: apiUrl,
                method: 'GET',
                data: {
                    consumer_key: consumerKey,
                    consumer_secret: consumerSecret,
                    per_page: ordersPerPage,
                    page: page
                },
                success: function(response, textStatus, xhr) {
                    if (Array.isArray(response) && response.length > 0) {
                        let orderList = '<ul>';
                        response.forEach(order => {
                            if (order.billing && order.shipping && order.line_items) {
                                const customer = order.billing;
                                const shipping = order.shipping;
                                const items = order.line_items;
                                const total = order.total;
                                const status = order.status;
                                const createdAt = order.date_created;

    
                                // فرمت تاریخ و ساعت
                                const formattedDate = formatDate(createdAt);
    
                                const cleanShippingAddress = cleanAddress(shipping.address_1, shipping.city, shipping.state, shipping.postcode);
                                const cleanBillingAddress = cleanAddress(customer.address_1, customer.city, customer.state, customer.postcode);
    
                                let productsList = '';
                                items.forEach(item => {
                                    productsList += `<div class="product">${item.name}</div>`;
                                });
    
                                orderList += `<li>
                                                <strong>شماره سفارش:</strong> ${order.id} <br>
                                                <strong>نام مشتری:</strong> ${customer.first_name} ${customer.last_name} <br>
                                                <strong>شماره تلفن:</strong> ${customer.phone} <br>
                                                <strong>ایمیل:</strong> ${customer.email} <br>
                                                <strong>وضعیت سفارش:</strong> ${status} <br>
                                                <strong>تاریخ و ساعت سفارش:</strong> ${formattedDate} <br>
                                                <div class="address">
                                                    <strong>آدرس صورتحساب:</strong> <br> 
                                                    ${cleanBillingAddress} <br> <br> 
                                                    <strong>آدرس ارسال:</strong> <br> 
                                                    ${cleanShippingAddress} <br> 
                                                </div>
                                                <strong>مبلغ پرداختی:</strong> ${total} <br>
                                                <div class="products-list">
                                                    <strong>کالاهای خریداری‌شده:</strong> <br>
                                                    ${productsList}
                                                </div>
                                               </li>`;
                            }
                        });
                        function displayOrders(orders) {
                            const ordersContainer = document.getElementById('orders-list');  // لیست سفارشات را به این تگ اضافه می‌کنیم

                            // اگر سفارشات وجود داشته باشد
                            if (orders && orders.length > 0) {
                                ordersContainer.innerHTML = '';  // لیست قبلی را پاک می‌کنیم

                                
                                orders.forEach(order => {
                                    const orderElement = document.createElement('div');
                                    orderElement.classList.add('order');

                                    // نمایش اطلاعات سفارش
                                    orderElement.innerHTML = `
                                        <p><strong>وضعیت سفارش:</strong> ${order.status}</p>
                                        <p><strong>کالاهای خریداری‌شده:</strong> ${order.line_items.map(item => item.name).join(', ')}</p>
                                        <p><strong>مبلغ پرداختی:</strong> ${order.total}</p>
                                        <p><strong>تاریخ و ساعت سفارش:</strong> ${order.date_created}</p>
                                        <p><strong>آدرس ارسال:</strong> ${order.shipping.address_1}, ${order.shipping.city}, ${order.shipping.country}</p>
                                    `;

                                   
                                    ordersContainer.appendChild(orderElement);
                                });
                            } else {
                                
                                ordersContainer.innerHTML = '<p>هیچ سفارشی یافت نشد.</p>';
                            }
                        }


                        orderList += '</ul>';
                        $('#order-list').html(orderList); // بروزرسانی محتوای سفارشات
                        displayPagination(page); // بروزرسانی صفحه‌بندی
                    } else {
                        alert("هیچ سفارشی پیدا نشد.");
                    }
                },
                error: function() {
                    alert('خطا در بارگذاری سفارشات');
                }
            });
        }
    
        // تابع برای پاک کردن کدهای اضافی از آدرس
        function cleanAddress(address, city, state, postcode) {
            return `${address} <br> ${city} <br> ${state} <br> ${postcode}`;
        }
    
        // تابع برای فرمت کردن تاریخ
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            
            return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
        }
    
        // تابع برای نمایش صفحه‌بندی
        function displayPagination(currentPage) {
            $.ajax({
                url: apiUrl,
                method: 'GET',
                data: {
                    consumer_key: consumerKey,
                    consumer_secret: consumerSecret,
                    per_page: ordersPerPage,
                    page: 1
                },
                success: function(response, textStatus, xhr) {
                    const totalOrders = parseInt(xhr.getResponseHeader('X-WP-Total'));
                    const totalPages = Math.ceil(totalOrders / ordersPerPage);
    
                    let pagination = '<div class="pagination">';
    
                    if (currentPage > 1) {
                        pagination += `<span class="page" onclick="fetchOrders(${currentPage - 1})">قبلی</span>`;
                    }
    
                    for (let i = 1; i <= totalPages; i++) {
                        if (i === currentPage) {
                            pagination += `<span class="page active">${i}</span>`;
                        } else {
                            pagination += `<span class="page" onclick="fetchOrders(${i})">${i}</span>`;
                        }
                    }
    
                    if (currentPage < totalPages) {
                        pagination += `<span class="page" onclick="fetchOrders(${currentPage + 1})">بعدی</span>`;
                    }
    
                    pagination += '</div>';
                    $('#pagination').html(pagination);
                },
                error: function() {
                    alert('خطا در بارگذاری تعداد صفحات');
                }
            });
        }
        function submitOrder(newOrderData) {
            $.ajax({
            url: 'https://YourWeb-site/wp-json/wc/v3/orders',  // آدرس ثبت سفارش جدید
            method: 'POST',
            data: newOrderData,  // داده‌های سفارش جدید
            success: function(response) {
                console.log('سفارش جدید با موفقیت ثبت شد!');
                fetchOrders(1);  
            },
            error: function() {
                alert('خطا در ثبت سفارش');
            }
                });
            }
        
        $(document).ready(function() {
            fetchOrders(); 
            setInterval(function() {
                fetchOrders(1);  // هر 30 ثانیه یکبار داده‌ها را از صفحه اول بارگذاری می‌کنیم
            }, 30000);
        });

        // برای دونیت یا چت خصوصی با من به ایدی زیر تو تلگرام پیام بدید 
        // @sudoweb_5026
    </script>
    
</body>
</html>
